!function(){"use strict";var e,t=window.wp.element,o=window.wp.data,l=window.wp.plugins,a=window.wp.editPost,n=window.wp.compose,i=window.wp.i18n,r=window.wp.components,d=window.wp.blockEditor,s=window.wp.editor,c=window.lodash;const u=["video"],m=[{value:"auto",label:(0,i.__)("Auto")},{value:"metadata",label:(0,i.__)("Metadata")},{value:"none",label:(0,i.__)("None")}],p={useLocal:!1,id:0,url:"",caption:"",useFeaturedImageAsPoster:!1,settings:{autoplay:!1,loop:!1,muted:!1,controls:!0,playsInline:!1,preload:"auto",poster:""}},g=null!==(e=sfvEditorData.isPremium)&&void 0!==e&&e,_=(0,o.withSelect)((e=>{const{getMedia:t}=e("core"),{getEditedPostAttribute:o}=e("core/editor"),l=o("meta");try{const e=JSON.parse(l.sfv_video);return(0,c.isObject)(e)?{featuredVideo:e,media:t(e.id),useLocalVideo:e.useLocal}:{featuredVideo:p,media:null,useLocalVideo:p.useLocal}}catch(e){return{featuredVideo:p,media:null,useLocalVideo:p.useLocal}}})),v=(0,o.withDispatch)(((e,t,o)=>{let{noticeOperations:l}=t,{select:a}=o;const{editPost:n}=e("core/editor"),{getEditedPostAttribute:i}=a("core/editor"),r=i("meta");let d={};try{d=JSON.parse(r.sfv_video)}catch(e){d=p}return{onUpdateMeta:(e,t)=>{d=(0,c.set)(d,e,t),n({meta:{sfv_video:JSON.stringify(d)}})},onDropVideo(e){a("core/block-editor").getSettings().mediaUpload({allowedTypes:u,filesList:e,onFileChange(e){let[t]=e;d.id=t.id,n({meta:{sfv_video:JSON.stringify(d)}})},onError(e){l.removeAllNotices(),l.createErrorNotice(e)}})},onRemoveVideo(){n({meta:{sfv_video:JSON.stringify(p)}})}}}));(0,l.registerPlugin)("plugin-simply-featured-video-panel",{render:(0,n.compose)(_,v)((e=>{let{featuredVideo:o,onUpdateMeta:l,onDropVideo:n,onRemoveVideo:p,media:_,noticeUI:v,useLocalVideo:E}=e;return(0,t.createElement)(s.PostTypeSupportCheck,{supportKeys:"custom-fields"},(0,t.createElement)(a.PluginDocumentSettingPanel,{title:(0,i.__)("Featured video")},v,(0,t.createElement)("div",{className:"editor-simply-featured-video"},(0,t.createElement)(r.ToggleControl,{label:(0,i.__)("Use media library"),help:E?(0,i.__)("Set video source from media library."):(0,t.createElement)(t.Fragment,null,`${(0,i.__)("Set Video source from url.")} `,(0,t.createElement)(r.ExternalLink,{href:"https://wordpress.org/support/article/embeds/#okay-so-what-sites-can-i-embed-from"},(0,i.__)("See supported video provider."))),onChange:e=>{l("useLocal",e)},checked:o.useLocal}),E?(0,t.createElement)(d.MediaUploadCheck,{fallback:(0,t.createElement)("p",null,(0,i.__)("To edit the featured video, you need permission to upload media."))},(0,t.createElement)(d.MediaUpload,{title:(0,i.__)("Featured video"),onSelect:e=>l("id",e.id),allowedTypes:u,value:o,render:e=>{let{open:a}=e;return(0,t.createElement)("div",{className:"editor-simply-featured-video__container"},0===o.id&&(0,t.createElement)("div",{className:"editor-simply-featured-video__dropzone"},(0,t.createElement)(r.Button,{onClick:a,className:"editor-simply-featured-video__toggle"},(0,i.__)("Set featured video")),(0,t.createElement)(r.DropZone,{onFilesDrop:n})),o.id>0&&(0,c.isNil)(_)&&(0,t.createElement)("div",{className:"editor-simply-featured-video__dropzone"},(0,t.createElement)(r.Spinner,null),(0,t.createElement)(r.DropZone,{onFilesDrop:n})),o.id>0&&!(0,c.isNil)(_)&&(0,t.createElement)(t.Fragment,null,(0,t.createElement)("div",{className:"editor-simply-featured-video__dropzone"},(0,t.createElement)(r.ResponsiveWrapper,{naturalWidth:_.media_details.width,naturalHeight:_.media_details.height,isInline:!0},(0,t.createElement)("video",{controls:!0},(0,t.createElement)("source",{src:_.source_url,type:_.mime_type}))),(0,t.createElement)(r.DropZone,{onFilesDrop:n})),(0,t.createElement)(r.Button,{onClick:a,isSecondary:!0},(0,i.__)("Replace video")),(0,t.createElement)(r.Button,{isDestructive:!0,onClick:p},(0,i.__)("Remove video")),g?(0,t.createElement)(r.ToggleControl,{label:(0,i.__)("Use featured image as poster"),onChange:e=>{l("useFeaturedImageAsPoster",e)},checked:o.useFeaturedImageAsPoster}):(0,t.createElement)(t.Fragment,null,(0,t.createElement)("p",null,(0,i.__)("Poster setting is only available in Pro."))),(0,t.createElement)(r.ToggleControl,{label:(0,i.__)("Autoplay"),onChange:e=>{l("settings.autoplay",e)},checked:o.settings.autoplay}),(0,t.createElement)(r.ToggleControl,{label:(0,i.__)("Loop"),onChange:e=>{l("settings.loop",e)},checked:o.settings.loop}),(0,t.createElement)(r.ToggleControl,{label:(0,i.__)("Muted"),onChange:e=>{l("settings.muted",e)},checked:o.settings.muted}),(0,t.createElement)(r.ToggleControl,{label:(0,i.__)("Playback controls"),onChange:e=>{l("settings.controls",e)},checked:o.settings.controls}),(0,t.createElement)(r.ToggleControl,{label:(0,i.__)("Play inline"),onChange:e=>{l("settings.playsInline",e)},checked:o.settings.playsInline}),(0,t.createElement)(r.SelectControl,{label:(0,i.__)("Preload"),value:o.settings.preload,onChange:e=>{l("settings.preload",e)},options:m,hideCancelButton:!0})))}})):(0,t.createElement)("div",null,(0,t.createElement)(r.TextControl,{label:"Video URL",value:o.url,onChange:e=>l("url",e)}),(0,t.createElement)(r.TextareaControl,{label:"Caption",value:o.caption,onChange:e=>l("caption",e)})))))})),icon:null})}();